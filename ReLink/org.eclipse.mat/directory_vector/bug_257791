ibm  collections mischaracterized as ibm . null created <span class="bz_obsolete"><a href="attachment.cgi?id=119688&amp;action=diff" name="attach_119688" title="patch">attachment 119688</a> <a href="attachment.cgi?id=119688&amp;action=edit" title="patch">[details]</a></span> patch  steps to reproduce: 1. use mat + dtfj to load an ibm  heap. 2. open class histogram 3. find java.util.hashmap  popup &gt; java collections &gt; collections grouped by size opens a view with a all collections of size zero  popup &gt; java collections &gt; hash entries causes a nullpointerexception  these problems are caused by mat recognizing ibm  collections as ibm  collections.  this patch fixes the problem. andrew, can you please advise on this one? - andreas. the diagnosis is correct, but i don't think the fix is quite right, as i've got an ibm java 6 dump without the org.apache.harmony.kernel.vm.vm class.  i'll see what other reliable class differences there are between the ibm  and  vms. created <span class="bz_obsolete"><a href="attachment.cgi?id=119763&amp;action=diff" name="attach_119763" title="patch to detirmine type of ibm vm">attachment 119763</a> <a href="attachment.cgi?id=119763&amp;action=edit" title="patch to detirmine type of ibm vm">[details]</a></span> patch to detirmine type of ibm vm  it seems that ibm java  has com.ibm.oti.vm.bootstrapclassloader$findclasslock and ibm java 6 doesn't, so perhaps this could be used instead.  i'll do some investigation to check this assumption. created <span class=""><a href="attachment.cgi?id=122656&amp;action=diff" name="attach_122656" title="patch to detirmine type of dump - ibm java 5/6/.2">attachment 122656</a> <a href="attachment.cgi?id=122656&amp;action=edit" title="patch to detirmine type of dump - ibm java 5/6/.2">[details]</a></span> patch to detirmine type of dump - ibm java 5/6/.2  the original code using com.ibm.oti.vm.abstractclassloader$cachelock to spot ibm java 6 doesn't work as recent ibm java 5 such as sr8 also has this class.  the proposed patch using com.ibm.oti.vm.bootstrapclassloader$findclasslock to spot ibm java 5 doesn't work as ibm java 5 ga does not have this class.  the current patch is to try using com.ibm.misc.javaruntimeversion to spot java 5. this class seems to be present and loaded with ibm java 5 ga and ibm java 5 sr8, but not present with ibm java 6. andrew, i tested the code on my sample dump. patch submitted. thanks. andreas. (hash map ) (null pointer exception ) (v ms ) (bootstrap class loader ) (find class lock ) (abstract class loader ) (cache lock ) (bootstrap class loader ) (find class lock ) (java runtime version ) ( sr ) ( 8 ) ( sr ) ( 8 ) 257791 257791 257791 257791