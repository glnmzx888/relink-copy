querybrowser misses the copy queries. null the query browser doesn't list the copy queries.  these queries have icontextobject arguments.  the problem is to do with whether the query accept the given context (which has most of the arguments) and the whether the policy is suitable. the policy holds the selection and so the icontextobjects etc. and the selected heap objects.  i don't think queries that need a icontextobjectset are properly filtered either  for a pop-up menu or search on selected row(s): only queries needing heap objects or context objects (rows) should be shown (i.e. the query should be affected by the selection of items) if the query requires icontextobjectset then all the rows should be of that type  for a menu from the tool bar queries that require a context object should not appear queries that require heap objects can (the wizard can fill those in)  the solution is to use the policy everywhere, and have a default policy which doesn't provide any icontextobjects. the uisnapshotquerycontext needs to say it has an icontextobjectset then the policy will determine if there is one. i've made the changes, and also added some test queries to check that the right queries appear when a icontextobject  icontextobject[]  icontextobjectset  icontextobjectset[]  are available. i've updated the command line for the query browser so that the iobjectcontext is filled in for the context browser, but not for the pop up browser. the copy queries now appear in the context menus and the context query browser but not in the pop up menus. (query browser ) (i context object ) (i context objects ) (i context object set ) (i context object set ) (i context objects ) (ui snapshot query context ) (i context object set ) (i context object ) (i context object ) (i context object set ) (i context object set ) (i object context ) 335047 335047 335047 335047