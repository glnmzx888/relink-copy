indexoutofboundsexception parsing ibm core dump. null using mat for windows x86_64, , with ibm  64-bit jre, with the ibm dtfj  installed, i'm getting the following exception trying to open heap dumps:  java.lang.arrayindexoutofboundsexception     at org.eclipse.mat.collect.setint.resize(setint.java:      at org.eclipse.mat.collect.setint.add(setint.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.processobject(indexwriter.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.processsegment(indexwriter.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.flush(indexwriter.java:      at org.eclipse.mat.parser.internal.garbagecleaner.clean(garbagecleaner.java:      at org.eclipse.mat.parser.internal.snapshotfactoryimpl.parse(snapshotfactoryimpl.java:      at org.eclipse.mat.parser.internal.snapshotfactoryimpl.opensnapshot(snapshotfactoryimpl.java:      at org.eclipse.mat.snapshot.snapshotfactory.opensnapshot(snapshotfactory.java:      at org.eclipse.mat.snapshot.snapshotfactory.opensnapshot(snapshotfactory.java:      at org.eclipse.mat.ui.snapshot.parseheapdumpjob.run(parseheapdumpjob.java:      at org.eclipse.core.internal.jobs.worker.run(worker.java:    this does not happen using version  with ibm dtfj . i can upload the heap dump (about 275 mb) to a private area for debugging if provided with a link. i looked at the coding of the setint class where the error is coming from and it hasn't changed since two years. but the way it is used has probably changed.   i'd like to try and reproduce this behavior with your heap dump. you can upload it here if you are willing to provide it: <a href="https://sapmats-de.sap-ag.de/upload/index.cgi?id=gskst44ftzhvonlny9eyk0lwczq4xjvbu103gp1lf6kdsivrhh">https://sapmats-de.sap-ag.de/upload/index.cgi?id=gskst44ftzhvonlny9eyk0lwczq4xjvbu103gp1lf6kdsivrhh</a>  alternatively i can send you a patched version of the setint class which will dump all internal fields on an arrayindexoutofboundsexception. this can give us more info about the exception, but i won't be able to look what happens at other places in the code, where the collection is being used. thanks for providing the heap dump. my first attempt was eunning a clean install of mat , win64, dtfj  and sun  vm - it worked fine. then i found some 32 bit ibm vm 6 for windows and run a x32 mat  + dtfj . with this one i could reproduce the problem.   looking at the code i'm really puzzled how an outofindex can happen at this place, but at least i'll have the possibility to debug it now.  the fact that it is vm specific makes it even more interesting :-) so i tried again a few more times with the exact same heap dumps. cleared the index files, blew away the mat workspace, and tried the exact sequence that i followed before. couldn't reproduce it. it just so happened that i got this exception on the first 2 dumps i tried to open, so i thought something was fundamentally broken for ibm core dump support. i guess that is not the case and it is some timing-related issue. at least you have reproduced it somehow.  strangely, the failure seems to be on the second line here. why did the failure not occur on the first line?                  used[hash] = true;                 keys[hash] = key; // &lt;= arrayindexoutofboundsexception i've reproduced the problem with some ibm vms: e.g. eclipse.buildid=unknown java.fullversion=jre .0 ibm j9  aix ppc64-64 jvmap6460sr6-20090923_42924 (jit enabled, aot enabled) j9vm - 20090923_042924 jit  - r9_20090902_1330ifx1 gc   - 20090817_aa bootloader constants: os=aix, arch=ppc64, ws=motif, nl=en_us framework arguments:  -application org.eclipse.mat.api.parse /tmp/aetmpdir/t.755.d/aex_out.d/heapdump...phd -report1 org.eclipse.mat.api:suspects -report2 org.eclipse.mat.api:top_components command-line arguments:  -consolelog -application org.eclipse.mat.api.parse /tmp/aetmpdir/t.755.d/aex_out.d/heapdump...phd -report1 org.eclipse.mat.api:suspects -report2 org.eclipse.mat.api:top_components  !entry org.eclipse.osgi 4 0 2010-06-24 01:28: !message application error !stack 1 java.lang.arrayindexoutofboundsexception     at org.eclipse.mat.collect.setint.resize(setint.java:      at org.eclipse.mat.collect.setint.add(setint.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.processobject(indexwriter.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.processsegment(indexwriter.java:      at org.eclipse.mat.parser.index.indexwriter$inboundwriter.flush(indexwriter.java:      at org.eclipse.mat.parser.internal.garbagecleaner.clean(garbagecleaner.java:      at org.eclipse.mat.parser.internal.snapshotfactoryimpl.parse(snapshotfactoryimpl.java:      at org.eclipse.mat.parser.internal.snapshotfactoryimpl.opensnapshot(snapshotfactoryimpl.java:      at org.eclipse.mat.snapshot.snapshotfactory.opensnapshot(snapshotfactory.java:      at org.eclipse.mat.internal.apps.parsesnapshotapp.parse(parsesnapshotapp.java:      at org.eclipse.mat.internal.apps.parsesnapshotapp.start(parsesnapshotapp.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   and from   java version &quot;.0&quot; java(tm) se runtime environment (build pap6460sr6-20090925_01(sr ) ibm j9 vm (build , jre .0 ibm j9  aix ppc64-64 jvmap6460sr6-20090923_42924 (jit enabled, aot enabled) j9vm - 20090923_042924 jit  - r9_20090902_1330ifx1 gc   - 20090817_aa) jcl  - 20090924_01  java version &quot;.0&quot; java(tm) se runtime environment (build pap6460sr6ifix-20091015_01(sr6+152211+155 930+ ) ibm j9 vm (build , jre .0 ibm j9  aix ppc64-64 jvmap6460sr6-20091001_43 491 (jit enabled, aot enabled) j9vm - 20091001_043491 jit  - r9_20090902_1330ifx1 gc   - 20090817_aa) jcl  - 20091006_01  java version &quot;.0&quot; java(tm) se runtime environment (build pap6460sr2-20080818_01(sr ) ibm j9 vm (build , j2re .0 ibm j9  aix ppc64-64 jvmap6460-20080816_2209 3 (jit enabled, aot enabled) j9vm - 20080816_022093_bhdsmr jit  - r9_20080721_1330ifx2 gc   - 20080724_aa) jcl  - 20080808_02  it works with   java version &quot;.0&quot; java(tm) 2 runtime environment, standard edition (build pap64dev-20091106a (sr11 )) ibm j9 vm (build , j2re .0 ibm j9  aix ppc64-64 j9vmap6423-20091104 (jit enabled) j9vm - 20091103_45935_bhdsmr jit  - 20091016_1845_r8 gc   - 20091026_aa) jcl  - 20091106 i've written some tests setinttest and setlongtest which fail with   java version &quot;.0&quot; java(tm) se runtime environment (build pwi3260sr7-20091217_01(sr ) ibm j9 vm (build , jre .0 ibm j9  windows xp x86-32 jvmwi3260sr7-20091214_49398 (jit enabled, aot enabled) j9vm - 20091214_049398 jit  - r9_20091123_13891 gc   - 20091111_aa) jcl  - 20091202_01  alltests (  org.eclipse.mat.tests.alltests org.eclipse.mat.tests.collect.setinttest testsetint1(org.eclipse.mat.tests.collect.setinttest) java.lang.assertionerror: every key should be contained     at org.junit.assert.fail(assert.java:      at org.junit.assert.asserttrue(assert.java:      at org.eclipse.mat.tests.collect.setinttest.testonesetint(setinttest.java:      at org.eclipse.mat.tests.collect.setinttest.testsetint1(setinttest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   testsetint2(org.eclipse.mat.tests.collect.setinttest) java.lang.assertionerror: contained items should equals the size expected:&lt;1892&gt; but was:&lt;1891&gt;     at org.junit.assert.fail(assert.java:      at org.junit.assert.failnotequals(assert.java:      at org.junit.assert.assertequals(assert.java:      at org.eclipse.mat.tests.collect.setinttest.testtwosetint(setinttest.java:      at org.eclipse.mat.tests.collect.setinttest.testsetint2(setinttest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   testsetint3(org.eclipse.mat.tests.collect.setinttest) java.lang.assertionerror: after a remove the key should not be contained     at org.junit.assert.fail(assert.java:      at org.junit.assert.asserttrue(assert.java:      at org.junit.assert.assertfalse(assert.java:      at org.eclipse.mat.tests.collect.setinttest.testthreesetint(setinttest.java:      at org.eclipse.mat.tests.collect.setinttest.testsetint3(setinttest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   org.eclipse.mat.tests.collect.setlongtest testsetlong1(org.eclipse.mat.tests.collect.setlongtest) java.lang.assertionerror: every key should be contained     at org.junit.assert.fail(assert.java:      at org.junit.assert.asserttrue(assert.java:      at org.eclipse.mat.tests.collect.setlongtest.testonesetlong(setlongtest.java:      at org.eclipse.mat.tests.collect.setlongtest.testsetlong1(setlongtest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   testsetlong2(org.eclipse.mat.tests.collect.setlongtest) java.lang.assertionerror: contained items should equals the size expected:&lt;1875&gt; but was:&lt;1872&gt;     at org.junit.assert.fail(assert.java:      at org.junit.assert.failnotequals(assert.java:      at org.junit.assert.assertequals(assert.java:      at org.eclipse.mat.tests.collect.setlongtest.testtwosetlong(setlongtest.java:      at org.eclipse.mat.tests.collect.setlongtest.testsetlong2(setlongtest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:   testsetlong3(org.eclipse.mat.tests.collect.setlongtest) java.lang.assertionerror: after a remove the key should not be contained     at org.junit.assert.fail(assert.java:      at org.junit.assert.asserttrue(assert.java:      at org.junit.assert.assertfalse(assert.java:      at org.eclipse.mat.tests.collect.setlongtest.testthreesetlong(setlongtest.java:      at org.eclipse.mat.tests.collect.setlongtest.testsetlong3(setlongtest.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.junit.internal.runners.testmethodrunner.executemethodbody(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.rununprotected(testmethodrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testmethodrunner.runmethod(testmethodrunner.java:      at org.junit.internal.runners.testmethodrunner.run(testmethodrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.invoketestmethod(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassmethodsrunner.run(testclassmethodsrunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.junit.internal.runners.compositerunner.run(compositerunner.java:      at org.junit.internal.runners.testclassrunner$1.rununprotected(testclassrunner.java:      at org.junit.internal.runners.beforeandafterrunner.runprotected(beforeandafterrunner.java:      at org.junit.internal.runners.testclassrunner.run(testclassrunner.java:      at org.eclipse.jdt.internal.junit4.runner.junit4testreference.run(junit4testreference.java:      at org.eclipse.jdt.internal.junit.runner.testexecution.run(testexecution.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtests(remotetestrunner.java:      at org.eclipse.jdt.internal.junit.runner.remotetestrunner.run(remotetestrunner.java:      at org.eclipse.pde.internal.junit.runtime.remoteplugintestrunner.main(remoteplugintestrunner.java:      at org.eclipse.pde.internal.junit.runtime.coretestapplication.run(coretestapplication.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.internal.app.eclipseappcontainer.callmethod(eclipseappcontainer.java:      at org.eclipse.equinox.internal.app.eclipseapphandle.run(eclipseapphandle.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.runapplication(eclipseapplauncher.java:      at org.eclipse.core.runtime.internal.adaptor.eclipseapplauncher.start(eclipseapplauncher.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at org.eclipse.core.runtime.adaptor.eclipsestarter.run(eclipsestarter.java:      at sun.reflect.nativemethodaccessorimpl.invoke0(native method)     at sun.reflect.nativemethodaccessorimpl.invoke(nativemethodaccessorimpl.java:      at sun.reflect.delegatingmethodaccessorimpl.invoke(delegatingmethodaccessorimpl.java:      at java.lang.reflect.method.invoke(method.java:      at org.eclipse.equinox.launcher.main.invokeframework(main.java:      at org.eclipse.equinox.launcher.main.basicrun(main.java:      at org.eclipse.equinox.launcher.main.run(main.java:      at org.eclipse.equinox.launcher.main.main(main.java:  i've coded two small modifications to setint and setlong which seem to resolve this problem on ibm java 6 vms. thanks andrew! i had about 0% chance to find the problem and work around it. (index out of bounds exception ) (array index out of bounds exception ) (set int ) (set int ) (set int ) (set int ) (index writer ) (inbound writer ) (index writer ) (index writer ) (inbound writer ) (index writer ) (index writer ) (inbound writer ) (index writer ) (garbage cleaner ) (garbage cleaner ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory ) (snapshot factory ) (snapshot factory ) (snapshot factory ) (parse heap dump job ) (parse heap dump job ) (set int ) (set int ) (array index out of bounds exception ) (out of index ) (array index out of bounds exception ) (v ms ) (boot loader ) (array index out of bounds exception ) (set int ) (set int ) (set int ) (set int ) (index writer ) (inbound writer ) (index writer ) (index writer ) (inbound writer ) (index writer ) (index writer ) (inbound writer ) (index writer ) (garbage cleaner ) (garbage cleaner ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory impl ) (snapshot factory ) (snapshot factory ) (parse snapshot app ) (parse snapshot app ) (parse snapshot app ) (parse snapshot app ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (b hd s mr ) (b hd s mr ) (set int test ) (set long test ) (all tests ) (all tests ) (set int test ) (set int test ) (assertion error ) (set int test ) (set int test ) (set int test ) (set int test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set int test ) (assertion error ) (set int test ) (set int test ) (set int test ) (set int test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set int test ) (assertion error ) (set int test ) (set int test ) (set int test ) (set int test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set long test ) (set long test ) (assertion error ) (set long test ) (set long test ) (set long test ) (set long test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set long test ) (assertion error ) (set long test ) (set long test ) (set long test ) (set long test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set long test ) (assertion error ) (set long test ) (set long test ) (set long test ) (set long test ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (before and after runner ) (before and after runner ) (test method runner ) (test method runner ) (test method runner ) (test method runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class methods runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (composite runner ) (composite runner ) (test class runner ) (test class runner ) (before and after runner ) (before and after runner ) (test class runner ) (test class runner ) (test execution ) (test execution ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote test runner ) (remote plugin test runner ) (remote plugin test runner ) (core test application ) (core test application ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (eclipse app container ) (eclipse app container ) (eclipse app handle ) (eclipse app handle ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse app launcher ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (eclipse starter ) (native method accessor impl ) (native method accessor impl ) (native method accessor impl ) (delegating method accessor impl ) (delegating method accessor impl ) (set int ) (set long ) (v ms ) ( x ) ( 86 ) ( win ) ( 64 ) ( x ) ( 32 ) ( j ) ( 9 ) ( ppc ) ( 64 ) ( r ) ( 9 ) ( ppc ) ( 64 ) ( t ) ( 0624 ) ( report ) ( 1 ) ( report ) ( 2 ) ( t ) ( 0624 ) ( report ) ( 1 ) ( report ) ( 2 ) ( invoke ) ( 0 ) ( sr ) ( 6 ) ( j ) ( 9 ) ( j ) ( 9 ) ( ppc ) ( 64 ) ( r ) ( 9 ) ( sr ) ( 6 ) ( j ) ( 9 ) ( j ) ( 9 ) ( ppc ) ( 64 ) ( r ) ( 9 ) ( sr ) ( 2 ) ( j ) ( 9 ) ( j ) ( 9 ) ( ppc ) ( 64 ) ( jvmap ) ( 6460 ) ( r ) ( 9 ) ( sr ) ( 11 ) ( j ) ( 9 ) ( j ) ( 9 ) ( ppc ) ( 64 ) ( r ) ( 8 ) ( sr ) ( 7 ) ( j ) ( 9 ) ( j ) ( 9 ) ( x ) ( 86 ) ( r ) ( 9 ) ( testsetint ) ( 1 ) ( testsetint ) ( 1 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) ( testsetint ) ( 2 ) ( testsetint ) ( 2 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) ( testsetint ) ( 3 ) ( testsetint ) ( 3 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) ( testsetlong ) ( 1 ) ( testsetlong ) ( 1 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) ( testsetlong ) ( 2 ) ( testsetlong ) ( 2 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) ( testsetlong ) ( 3 ) ( testsetlong ) ( 3 ) ( invoke ) ( 0 ) ( junit ) ( 4 ) ( invoke ) ( 0 ) ( invoke ) ( 0 ) 314552 314552 314552 314552